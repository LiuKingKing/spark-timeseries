goptions vsize=6.8cm hsize=10cm;
data a;
input x@@;
lagx=lag(x);
difx=dif(x);
t=intnx('weekday','04jan2013'd,_n_-1);
format  t monyy5.;
cards;
2276.991943
2285.364014
2276.070068
2275.340088
2283.656982
2242.99707
2311.73999
2325.681885
2309.499023
2284.908936
2317.070068
2328.220947
2315.138916
2320.910889
2302.5979
2291.303955
2346.504883
2358.977051
2382.475098
2385.422119
2419.02002
2428.154053
2433.129883
2434.477051
2418.530029
2432.4021
2421.558105
2382.914063
2397.177979
2325.950928
2314.164063
2325.819092
2293.341064
2313.219971
2365.593018
2359.506104
2273.404053
2326.305908
2347.178955
2324.292969
2318.611084
2310.593018
2286.60498
2263.968018
2270.2771
2278.400879
2240.016113
2257.434082
2317.375
2324.241943
2328.278076
2326.715088
2297.668945
2301.26001
2236.302002
2236.621094
2234.39502
2227.73999
2225.294922
2211.592041
2225.773926
2226.125977
2219.552979
2206.780029
2181.940918
2194.844971
2193.795898
2197.602051
2244.643066
2242.168945
2184.538086
2218.318115
2199.306885
2177.912109
2174.123047
2205.49707
2231.166016
2235.574951
2246.300049
2232.970947
2246.831055
2241.919922
2217.01001
2224.797119
2251.804932
2282.870117
2299.986084
2305.114014
2302.403076
2275.666992
2288.531982
2293.076904
2321.318115
2324.01709
2317.749023
2300.594971
2299.251953
2272.416992
2270.929932
2242.110107
2210.897949
2148.35498
2162.041016
2156.215088
2159.291016
2143.454102
2084.020996
2073.094971
1963.234985
1959.508057
1951.494995
1950.011963
1979.206055
1995.241943
2006.560059
1994.267944
2006.098022
2007.198975
1958.272949
1965.453979
2008.125977
2072.990967
2039.485962
2059.389893
2065.719971
2044.921997
2023.395996
1992.647949
2004.761963
2043.875977
2033.328979
2021.17395
2010.849976
1976.30603
1990.063965
1993.79895
2029.067017
2029.417969
2050.480957
2060.5
2046.777954
2044.89502
2052.235107
2101.282959
2106.156006
2100.136963
2081.879883
2068.451904
2085.602051
2072.594971
2072.960938
2067.124023
2057.458008
2096.474121
2103.565918
2101.301025
2097.227051
2098.38208
2098.447998
2123.112061
2127.61792
2122.429932
2139.99292
2212.516113
2237.983887
2241.268066
2255.604004
2236.217041
2231.400879
2185.560059
2191.851074
2221.043945
2207.531006
2198.514893
2155.809082
2160.0271
2174.665039
2198.198975
2211.769043
2190.928955
2228.145996
2237.772949
2233.412109
2193.073975
2188.541992
2193.780029
2229.237061
2210.6521
2183.106934
2164.322021
2132.955078
2133.868896
2128.864014
2160.462891
2141.614014
2149.562012
2149.634033
2157.23999
2139.606934
2129.399902
2106.126953
2109.470947
2126.771973
2087.940918
2100.506104
2135.826904
2197.218994
2193.125
2206.613037
2205.766113
2196.37793
2186.11499
2183.072998
2201.070068
2219.37207
2220.503906
2207.371094
2222.669922
2251.761963
2247.062988
2237.10791
2238.199951
2237.491943
2204.166016
2202.795898
2196.074951
2160.861084
2151.079102
2148.284912
2127.791992
2084.793945
2089.707031
2092.905029
2106.354004
2073.099121
2101.250977
2097.529053
2115.978027
2109.386963
2083.13501
2045.708984
2047.317017
2044.339966
2027.621948
2013.297974
2009.563965
2026.842041
2023.348022
2023.70105
2004.948975
1991.253052
2008.312988
2051.749023
2042.180054
2054.39209
2033.300049
2038.512939
2049.914063
2033.083008
2044.496948
2086.066895
2103.670898
2109.955078
2098.400879
2115.8479
2135.415039
2119.065918
2142.553955
2138.781982
2113.693115
2076.686035
2034.218994
2041.254028
2047.354004
2056.302002
2075.235107
2071.4729
2053.083984
2059.577881
2057.907959
1999.064941
2001.156982
1997.692017
2019.110962
2004.338989
2023.672974
2025.196045
2021.734009
1993.479004
2047.619019
2066.279053
2067.311035
2063.669922
2046.588013
2041.712036
2033.30603
2047.459961
2058.988037
2043.702026
2058.831055
2098.283936
2105.237061
2134.300049
2130.541992
2131.539063
2101.601074
2105.12207
2098.88501
2097.748047
2065.825928
2072.831055
2067.38208
2057.032959
2036.519043
2003.487061
2020.340942
2026.358032
2027.353027
2028.037964
2010.083008
2015.274048
2011.13501
2052.871094
2050.728027
2047.910034
2024.973999
2026.504028
2005.182983
2008.119019
2024.95105
2021.285034
2034.56897
2041.475952
2034.564941
2050.228027
2040.594971
2039.212036
2038.305054
2024.833984
2040.878052
2029.956055
2030.501953
2052.531982
2054.947998
2051.712891
2070.715088
2085.98291
2066.697998
2055.519043
2023.734985
2026.67395
2024.36499
2033.93103
2025.501953
2038.677002
2036.51001
2048.326904
2050.381104
2059.417969
2063.229004
2059.375
2059.927002
2064.020996
2038.612061
2038.342041
2046.96106
2066.645996
2070.356934
2067.275879
2055.591064
2059.066895
2054.479004
2075.480957
2078.489014
2105.062012
2126.614014
2177.947998
2183.191895
2181.24292
2201.562012
2185.302979
2223.331055
2219.945068
2217.465088
2187.668945
2194.425049
2224.654053
2221.594971
2222.876953
2206.466064
2226.733887
2239.466064
2245.330078
2240.210938
2230.458008
2240.812012
2229.273926
2207.105957
2209.465088
2195.818115
2217.199951
2235.510986
2266.045898
2288.626953
2306.862061
2326.431885
2326.5271
2318.304932
2311.678955
2331.949951
2339.139893
2296.554932
2307.893066
2315.927979
2329.450928
2289.865967
2309.718018
2343.574951
2345.103027
2347.718018
2357.710938
2363.870117
2382.793945
2389.371094
2374.540039
2366.009033
2359.475098
2373.669922
2356.499023
2341.184082
2356.728027
2339.656982
2326.552979
2302.417969
2302.280029
2290.437012
2337.871094
2373.030029
2391.075928
2420.177979
2430.970947
2430.737061
2420.395996
2425.809082
2419.145996
2473.183105
2470.594971
2494.275879
2486.669922
2479.185059
2475.120117
2457.529053
2451.166992
2452.616943
2487.111084
2533.887939
2567.596924
2604.886963
2630.045898
2682.918945
2680.73999
2763.316895
2779.736084
2900.362061
2938.781006
3021.523926
2859.918945
2940.876953
2925.74292
2938.173096
2953.420898
3021.518066
3061.02002
3057.520996
3108.595947
3127.445068
3032.612061
2972.531982
3157.603027
3168.016113
3165.814941
3234.677002
3350.519043
3351.446045
3373.954102
3293.456055
3285.412109
3229.315918
3235.301025
3222.437012
3336.455078
3376.495117
3116.351074
3173.052002
3323.611084
3343.343994
3351.763916
3383.181885
3352.959961
3305.738037
3262.304932
3210.363037
3128.300049
3204.906982
3174.125977
3136.531006
3075.906982
3095.124023
3141.593018
3157.704102
3173.416016
3203.826904
3222.363037
3246.906006
3228.843018
3298.358887
3310.302979
3336.284912
3263.052002
3279.532959
3248.476074
3241.187012
3302.407959
3286.068115
3290.899902
3349.322998
3372.910889
3449.304932
3502.846924
3577.301025
3582.270996
3617.318115
3687.728027
3691.409912
3660.727051
3682.094971
3691.095947
3786.568115
3747.898926
3810.293945
3825.783936
3863.928955
3961.37793
3994.811035
3957.533936
4034.310059
4121.714844
4135.564941
4084.163086
4194.823242
4287.295898
4217.077148
4293.623047
4398.494141
4414.507813
4393.686035
4527.395996
4476.214844
4476.620117
4441.654785
4480.463867
4298.706055
4229.266113
4112.213867
4205.916992
4333.583984
4401.219238
4375.759766
4378.311035
4308.690918
4283.491211
4417.551758
4446.288086
4529.421875
4657.596191
4813.797852
4910.896973
4941.713867
4620.266113
4611.744141
4828.737793
4910.526855
4909.978027
4947.102051
5023.096191
5131.880859
5113.53418
5106.036133
5121.592773
5166.350098
5062.993164
4887.432129
4967.897949
4785.355957
4478.36377
4576.492188
4690.149902
4527.778809
4192.873047
4053.030029
4277.222168
4053.699951
3912.76709
3686.915039
3775.912109
3727.125
3507.191895
3709.330078
3877.802979
3970.387939
3924.487061
3805.702881
3823.176025
3957.352051
3992.110107
4017.675049
4026.044922
4123.922852
4070.907959
3725.558105
3663.001953
3789.167969
3705.766113
3663.726074
3622.905029
3756.544922
3694.572998
3661.539063
3744.205078
3928.415039
3927.907959
3886.320068
3954.555908
3965.334961
3993.667969
3748.164063
3794.108887
3664.291016
3507.743896
3209.905029
2964.967041
2927.288086
3083.591064
3232.350098
3205.986084
3166.624023
3160.166992
3080.419922
3170.451904
3243.089111
3197.893066
3200.233887
3114.798096
3005.172119
3152.262939
3086.061035
3097.916992
3156.540039
3185.618896
3115.887939
3142.687012
3092.346924
3100.756104
3038.136963
3052.781006
3143.356934
3183.1521
3287.662109
3293.22998
3262.440918
3338.072998
3391.352051
3386.699951
3425.330078
3320.676025
3368.739014
3412.434082
3429.581055
3434.335938
3375.196045
3387.314941
3382.561035
3325.084961
3316.695068
3459.639893
3522.819092
3590.031982
3646.881104
3640.485107
3650.249023
3632.9021
3580.839111
3606.957031
3604.794922
3568.468018
3617.062012
3630.5
3610.314941
3616.113037
3647.929932
3635.552002
3436.302979
3445.405029
3456.309082
3536.905029
3584.823975
3524.991943
3536.927002
3470.070068
3472.438965
3455.495117
3434.581055
3520.667969
3510.354004
3516.187012
3579.999023
3578.964111
3642.471924
3651.76709
3636.089111
3612.485107
3628.000977
3533.779053
3563.736084
3572.875977
3539.181885
3296.258057
3287.710938
3361.840088
3125.001953
3186.412109
3016.704102
3022.861084
2949.596924
3007.648926
2900.969971
2913.836914
3007.739014
2976.694092
2880.481934
2916.562012
2938.514893
2749.784912
2735.558105
2655.660889
2737.600098
2688.854004
2749.570068
2739.24707
2781.022949
2763.491943
2746.196045
2836.571045
2867.337891
2862.893066
2860.020996
2927.175049
2903.331055
2928.895996
2741.245117
2767.209961
2687.979004
2733.169922
2849.680908
2859.758057
2874.146973
2897.340088
2901.386963
2862.555908
2804.726074
2810.306885
2859.499023
2864.36792
2870.429932
2904.832031
2955.149902
3018.802002
2999.363037
3009.959961
2960.969971
2979.125977
2957.820068
2919.832031
3000.64502
3003.915039
3009.530029
3053.064941
3050.592041
3008.419922
2984.958008
3033.957031
3023.645996
3066.637939
3082.362061
3078.116943
3033.659912
3042.822998
2972.583984
2952.891113
2959.23999
2946.669922
2964.699951
2953.670898
2945.589111
2938.323975
2992.643066
2991.271973
2997.842041
2913.248047
2832.113037
2832.591064
2837.037109
2835.862061
2827.108887
2850.862061
2843.684082
2807.513916
2806.906006
2825.48291
2843.64502
2821.666016
2815.085938
2822.443115
2821.045898
2822.450928
2916.615967
2913.508057
2925.229004
2938.681885
2934.0979
2936.044922
2927.158936
2833.071045
2842.188965
2887.209961
2872.816895
2885.10498
2888.809082
2878.558105
2905.550049
2891.959961
2854.285889
2895.702881
2912.556885
2931.592041
2929.605957
2932.476074
2988.604004
3006.39209
3017.291992
3016.846924
2988.093994
2994.916992
3049.381104
3060.688965
3054.018066
3054.295898
3043.563965
3036.5979
3027.899902
3039.009033
3012.815918
3015.827881
3050.166016
2991.999023
2994.322998
2979.339111
2953.38501
2971.279053
2978.460938
2982.426025
2976.696045
3004.2771
3025.680908
3018.746094
3002.637939
3050.666992
3125.195068
3110.037109
3109.554932
3104.114014
3108.102051
3084.804932
3089.706055
3085.879883
3068.329102
3070.309082
3070.0271
3074.677002
3085.490967
3063.304932
3067.352051
3072.094971
3090.712891
3091.927979
3095.954102
3078.85498
3021.977051
3023.51001
3002.849121
3026.051025
3023
3025.874023
3042.312988
3033.895996
2980.429932
2998.172119
2987.85791
2998.48291
3004.702881
3048.143066
3065.25
3058.498047
3061.345947
3063.809082
3041.166016
3083.875
3084.718994
3084.458008
3090.940918
3128.24707
3131.938965
3116.312012
3112.350098
3104.27002
3100.491943
3122.436035
3102.73291
3128.936035
3125.316895
3133.333008
3147.887939
3128.370117
3171.281982
3196.043945
3210.371094
3206.986084
3205.056885
3208.452881
3192.855957
3218.147949
3248.352051
3241.136963
3241.736084
3261.937988
3277
3282.924072
3250.033936
3273.309082
3243.843018
3204.708984
3199.646973
3222.241943
3215.365967
3232.883057
3152.969971
3155.037109
3140.531006
3117.677002
3122.981934
3118.084961
3102.875977
3137.429932
3139.558105
3110.154053
3122.569092
3114.664063
3102.236084
3096.096924
3103.636963
3135.920898
3158.793945
3165.410889
3154.321045
3171.236084
3161.670898
3136.753906
3119.289063
3112.763916
3103.427979
3108.774902
3113.011963
3101.299072
3123.138916
3136.774902
3142.552979
3149.554932
3159.166016
3140.169922
3156.983887
3153.087891
3166.981934
3183.178955
3196.698975
3216.839111
3217.927979
3212.986084
3229.61792
3202.075928
3239.960938
3253.325928
3261.218018
3251.375
3253.433105
3228.659912
3241.73291
3246.934082
3230.028076
3218.312012
3233.865967
3242.406006
3240.665039
3216.746094
3212.76001
3237.023926
3239.327881
3241.76001
3268.935059
3237.447021
3250.808105
3261.611084
3245.219971
3248.550049
3269.445068
3266.955078
3252.947998
3241.313965
3210.237061
3222.513916
3270.304932
3281.004883
3286.615967
3269.393066
3288.966064
3273.830078
3275.959961
3244.48291
3222.166992
3196.712891
3170.687012
3172.100098
3173.150879
3129.531006
3134.566895
3140.846924
3152.187012
3154.657959
3143.711914
3135.345947
3127.368896
3103.038086
3078.613037
3080.5271
3052.784912
3061.5
3083.512939
3090.229004
3112.964111
3104.441895
3090.138916
3090.631104
3075.676025
3061.947021
3064.075928
3107.831055
3110.059082
3117.177979
3102.623047
3105.540039
3091.656006
3102.125977
3140.324951
3150.333984
3158.399902
3139.876953
3153.74292
3130.674072
3132.486084
3123.166016
3144.374023
3140.013916
3156.211914
3147.452881
3157.873047
3185.444092
3191.197021
3173.200928
3188.062988
3192.427002
3195.912109
3182.803955
3207.134033
3212.444092
3217.957031
3212.63208
3203.038086
3197.543945
3218.163086
3222.416992
3176.465088
3187.566895
3230.976074
3244.86499
3237.981934
3250.599121
3243.688965
3247.675049
3249.781006
3253.23999
3273.028076
3292.637939
3285.056885
3272.928955
3262.081055
3279.457031
3281.873047
3275.572998
3261.749023
3208.541016
3237.360107
3251.261963
3246.450928
3268.429932
3268.724121
3286.906006
3290.226074
3287.705078
3271.511963
3331.521973
;
proc gplot data=a;
plot x*t=1 difx*t=1;
symbol v=none i=join c=black;
run;
proc arima data=a;
identify var=x(1) stationarity=(pp) ;
estimate p=0 q=0 noint;
forecast lead=5 id=t ;
run; 
proc autoreg data=a;
model difx=/noint  archtest  garch=(q=4) method=ML;
model difx=/noint  archtest  garch=(p=1,q=1);
output  out=out lcl=lcl ucl=ucl ht=ht r=residuals;
run;
proc capability data=out;
var residuals;
qqplot residuals/normal;
run;
data out;
set out;
et=residuals/sqrt(ht);
et_2=et*et;
l=-1.96*52;
u=1.96*52;
run;
proc arima data=out;
identify var=et;
identify var=et_2;
run;
proc gplot data=out;
plot difx*t=2  l*t=3 u*t=3  /overlay;
plot difx*t=2 l*t=3 u*t=3  lcl*t=4 ucl*t=4  /overlay;
plot l*t=3 u*t=3  lcl*t=4 ucl*t=4  /overlay;
symbol2 c=green i=join v=none ;
symbol3 c=black i=join v=none l=2;
symbol4 c=red i=join v=none;
run;

